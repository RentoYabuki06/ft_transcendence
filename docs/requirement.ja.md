# ft_transcendence 要件定義書

## V.2 Web モジュール
これらのモジュールは、Pongゲームに高度なWeb機能の統合を可能にします。

### Major module: バックエンドフレームワークの使用
このメジャーモジュールでは、バックエンド開発に特定のWebフレームワークを使用することが必要です。

**要件：**
- **使用技術：** Fastify with Node.js
- デフォルトのバックエンド言語を使用してバックエンドを作成することも可能ですが、このモジュールが有効になるのは上記要件に従った場合のみです

**実装内容：**
- Fastify フレームワークを使用したRESTful API の構築
- Node.js ランタイム環境での実行
- 高性能なHTTPサーバーの実装

### Minor module: フロントエンドフレームワーク・ツールキットの使用
フロントエンド開発では、特定の技術スタックを使用する必要があります。

**要件：**
- **必須技術：** TypeScript + Tailwind CSS
- **制限：** 上記以外の技術は使用不可

**実装内容：**
- TypeScript による型安全な開発
- Tailwind CSS によるスタイリング
- レスポンシブデザインの実装

### Minor module: バックエンドデータベースの使用
プロジェクト全体のデータベースインスタンスに指定されたデータベースを使用します。

**要件：**
- **使用データベース：** SQLite
- 全プロジェコンポーネント間でのデータ一貫性と互換性を保証
- 他のモジュール（バックエンドフレームワークモジュールなど）の前提条件となる場合があります

## V.3 ユーザー管理モジュール
このモジュールは、Pongプラットフォーム内でのユーザー相互作用とアクセス制御の重要な側面を扱います。

### Major module: 標準ユーザー管理、認証、トーナメント間のユーザー管理

**機能要件：**
- ユーザーがWebサイトに安全に登録できる
- 登録ユーザーが安全にログインできる
- ユーザーがトーナメント参加用の一意の表示名を選択できる
- ユーザーが自身の情報を更新できる
- ユーザーがアバターをアップロードできる（未提供の場合はデフォルトオプション）
- ユーザーが他ユーザーを友達として追加し、オンラインステータスを表示できる
- ユーザープロファイルに勝敗などの統計情報を表示
- 各ユーザーに1v1ゲーム、日付、関連詳細を含むマッチ履歴（ログインユーザーがアクセス可能）

**技術的考慮事項：**
- 重複ユーザー名/メールアドレスの管理は実装者の裁量
- 論理的な解決策の提供が必要

### Major module: リモート認証の実装
OAuth 2.0を使用した安全な外部認証システムの実装を目的とします。

**要件：**
- **認証プロバイダー：** Google OAuth 2.0

**主要機能と目標：**
- ユーザーが安全にサインインできる認証システムの統合
- 安全なログインを可能にするために必要な認証情報と権限の取得
- ベストプラクティスとセキュリティ基準に準拠したユーザーフレンドリーなログインと認証フローの実装
- Webアプリケーションと認証プロバイダー間での認証トークンとユーザー情報の安全な交換

## V.4 ゲームプレイとユーザーエクスペリエンス

### Major module: リモートプレイヤー
リモートロケーションからのプレイヤー参加を可能にするシステムの実装を目的とします。

**主要機能と目標：**
- 異なる地理的場所にいるプレイヤー間でのリアルタイムゲームプレイの実現
- ネットワーク遅延の最小化と同期の最適化
- 接続品質に応じた自動調整機能
- 切断時の再接続機能とゲーム状態の復元

### Major module: マルチプレイヤー（2人以上のゲーム）
同じゲームで2人を超える複数プレイヤーの参加を可能にします。

**主要機能と目標：**
- 3人以上のプレイヤーが同時に参加できるゲームモードの実装
- プレイヤー間の公平性を保つためのゲームバランス調整
- 複数プレイヤー向けのスコアリングシステム
- チームプレイやトーナメントモードの対応

### Major module: 別ゲームの追加（ユーザー履歴とマッチメイキング機能付き）
Pong以外の追加ゲームを統合し、包括的な履歴とマッチメイキング機能を提供します。

**主要機能と目標：**
- Pong以外の新しいゲームの実装
- すべてのゲーム間でのユーザー履歴の統合管理
- スキルベースのマッチメイキングシステム
- ゲーム間でのランキングと統計情報の提供
- 統一されたユーザーエクスペリエンス

### Minor module: ゲームカスタマイゼーションオプション
プラットフォーム上で利用可能なすべてのゲームにカスタマイゼーションオプションを提供することを目的とします。

**主要機能と目標：**
- パワーアップ、攻撃、異なるマップなど、ゲームプレイ体験を向上させるカスタマイゼーション機能の提供
- よりシンプルな体験を好むユーザー向けに、基本機能を持つデフォルトバージョンの選択を可能にする
- プラットフォーム上で提供されるすべてのゲームにカスタマイゼーションオプションが利用可能で適用可能であることを保証
- ゲームパラメータを調整するためのユーザーフレンドリーな設定メニューまたはインターフェースの実装
- 統一されたユーザー体験を提供するため、すべてのゲーム間でカスタマイゼーション機能の一貫性を維持

**目標：**
多様なカスタマイゼーションオプションを提供することで、利用可能なすべてのゲーム間でユーザーがゲーム体験を調整できる柔軟性を提供し、同時に直接的なゲームプレイ体験を好む人向けにデフォルトバージョンも提供する。

### Major module: ライブチャット
プラットフォーム上でのリアルタイムコミュニケーション機能の実装を目的とします。

**主要機能と目標：**
- ゲーム中およびロビーでのリアルタイムテキストチャット
- プライベートメッセージング機能
- チャット履歴の保存と検索
- 不適切なコンテンツのフィルタリングとモデレーション
- 絵文字やステッカー機能の統合

## V.5 AI-アルゴリズム
これらのモジュールは、プロジェクトにデータ駆動要素を導入することを目的としています。

### Major module: AI対戦相手の導入
ゲームにAIプレイヤーを組み込むことを目的とします。

**制限事項：**
- **禁止アルゴリズム：** A*アルゴリズムの使用は許可されません

**主要機能と目標：**
- ユーザーにとって挑戦的で魅力的なゲームプレイ体験を提供するAI対戦相手の開発
- **重要な制約：** AIは人間の行動を再現する必要があり、AI実装ではキーボード入力をシミュレートする必要があります
- **パフォーマンス制約：** AIは1秒に1回のみゲームビューを更新でき、バウンスやその他のアクションを予測する必要があります
- ゲームカスタマイゼーションオプションモジュールを実装した場合、AIはパワーアップを利用する必要があります
- AI論理と意思決定プロセスの実装により、AIプレイヤーが知的で戦略的な動きを可能にする
- A*に依存せずに効果的なAIプレイヤーを作成するための代替アルゴリズムと技術の探索
- 異なるゲームプレイシナリオとユーザー相互作用にAIが適応することを保証

**評価要件：**
- 評価中にAIの動作原理を詳細に説明する必要があります
- 何もしないAIの作成は厳格に禁止されており、時折勝利する能力を持つ必要があります

### Minor module: ユーザーおよびゲーム統計ダッシュボード
個々のユーザーとゲームセッションの統計情報を表示するダッシュボードの導入を目的とします。

**主要機能と目標：**
- ユーザーにゲーム統計情報への洞察を提供するユーザーフレンドリーなダッシュボードの作成
- 各マッチの詳細な統計情報、結果、履歴データを表示するゲームセッション用の個別ダッシュボードの開発
- データの追跡と分析のための直感的で情報豊富なユーザーインターフェースの提供
- チャートやグラフなどのデータ可視化技術を実装し、統計情報を明確で視覚的に魅力的な方法で表示
- ユーザーが自身のゲーム履歴とパフォーマンス指標に便利にアクセスし探索できるようにする
- 有用と思われる任意の指標の自由な追加

## V.2-2 Web（追加モジュール）

### Major module: ブロックチェーンでのトーナメントスコア保存
ブロックチェーン技術を使用してトーナメントの結果を不変的に保存するシステムの実装を目的とします。

**主要機能と目標：**
- ブロックチェーン上でのトーナメント結果の永続的保存
- スマートコントラクトによる自動スコア記録
- 結果の改ざん不可能性の保証
- 透明性のある検証可能な競技結果
- 分散台帳による信頼性の確保

## V.7 DevOps
これらのモジュールは、プロジェクトの運用、監視、およびインフラストラクチャ管理を強化することを目的としています。

### Major module: ログ管理のためのインフラストラクチャ設定
包括的なログ管理システムのインフラストラクチャ構築を目的とします。

**主要機能と目標：**
- 集中化されたログ収集と保存システムの実装
- ログの分類、フィルタリング、検索機能
- リアルタイムログ監視とアラート機能
- ログローテーションとアーカイブ戦略
- セキュリティイベントの追跡と分析

### Minor module: モニタリングシステム
システムパフォーマンスと可用性を監視するシステムの実装を目的とします。

**主要機能と目標：**
- サーバーリソース（CPU、メモリ、ディスク）の監視
- アプリケーションパフォーマンス指標の追跡
- 稼働時間と可用性の監視
- 自動アラート機能とエスカレーション
- パフォーマンスダッシュボードの提供

### Major module: マイクロサービス設計によるバックエンド
バックエンドをマイクロサービスアーキテクチャで設計・実装することを目的とします。

**主要機能と目標：**
- 機能別に分離されたマイクロサービスの実装
- サービス間通信の設計と最適化
- API ゲートウェイによる統一されたエンドポイント
- 各サービスの独立したデプロイメント能力
- 障害耐性と自動復旧機能の実装

## V.10 Server-Side Pong
これらのモジュールは、サーバーサイドでのPong実装と外部アクセス機能を提供します。

### Major module: サーバーサイドPongとAPIの実装
基本的なPongをサーバーサイド実装に置き換え、APIを実装することを目的とします。

**主要機能と目標：**
- サーバーサイドでのゲームロジック実装
- ゲーム状態管理のAPI設計と実装
- クライアント-サーバー間のリアルタイム通信
- ゲームセッション管理機能
- 不正行為防止のためのサーバーサイド検証

### Major module: CLI対戦機能（Web ユーザーとのAPI統合）
コマンドラインインターフェース経由でWebユーザーと対戦できる機能の実装を目的とします。

**主要機能と目標：**
- CLI クライアントからのPong ゲームプレイ機能
- Web ユーザーとCLI ユーザー間での対戦マッチング
- API統合による統一されたゲーム体験
- CLI 専用のゲームインターフェース実装
- クロスプラットフォーム対戦機能の提供

## V.6 サイバーセキュリティ
これらのサイバーセキュリティモジュールは、プロジェクトのセキュリティ態勢を強化するように設計されています。メジャーモジュールはWebアプリケーションファイアウォール（WAF）とModSecurityの設定、およびセキュアなシークレット管理のためのHashiCorp Vaultによる堅牢な保護に焦点を当てています。マイナーモジュールは、GDPR準拠、ユーザーデータ匿名化、アカウント削除、二要素認証（2FA）、およびJSON Web Tokens（JWT）の機能を追加することで、データ保護、プライバシー、認証セキュリティへのプロジェクトのコミットメントを総合的に保証します。

### Major module: WAF/ModSecurityとHashiCorp Vaultの実装
このメジャーモジュールでは、堅牢なセキュリティ設定とシークレット管理の実装を目的とします。

**主要機能と目標：**
- **WAF/ModSecurity：** 堅牢な設定によるWebアプリケーションファイアウォール（WAF）とModSecurityの実装
- **HashiCorp Vault：** セキュアなシークレット管理のためのHashiCorp Vaultの統合
- 高度なセキュリティ設定による脅威からの保護
- 機密情報とAPIキーの安全な管理
- セキュリティインシデントの検知と防御機能の実装

### Minor module: GDPR準拠オプション（ユーザー匿名化、ローカルデータ管理、アカウント削除）
ユーザーがデータプライバシー権利を行使できるGDPR準拠オプションの導入を目的とします。

**主要機能と目標：**
- ユーザーが個人データの匿名化を要求できるGDPR準拠機能の実装（身元と機密情報の保護）
- システム内に保存された個人情報の表示、編集、削除能力を含む、ユーザーがローカルデータを管理するツールの提供
- アカウントと関連するすべてのデータの永続的削除をユーザーが要求できる合理化されたプロセスの提供（データ保護規則への準拠を保証）
- ユーザーのデータプライバシー権利に関する明確で透明なコミュニケーションの維持（これらの権利を行使するための簡単にアクセス可能なオプション付き）

**GDPR理解の重要性：**
一般データ保護規則（GDPR）に詳しくない場合は、特にユーザーデータ管理とプライバシーに関して、その原則と影響を理解することが不可欠です。GDPRは、欧州連合（EU）と欧州経済領域（EEA）内の個人の個人データとプライバシーを保護することを目的とした規則です。

### Major module: 二要素認証（2FA）とJWTの実装
二要素認証（2FA）の導入とJSON Web Tokens（JWT）の利用によりセキュリティとユーザー認証を強化することを目的とします。

**主要機能と目標：**
- ユーザーアカウント用の追加セキュリティ層として二要素認証（2FA）を実装（パスワードに加えてワンタイムコードなどの二次認証方法をユーザーに要求）
- 認証と認可のための安全な方法としてJSON Web Tokens（JWT）を利用（ユーザーセッションとリソースへのアクセスが安全に管理されることを保証）
- SMSコード、認証アプリ、またはメールベース認証のオプションを含む、2FA有効化のためのユーザーフレンドリーなセットアッププロセスの提供
- ユーザーアカウントと機密データへの不正アクセスを防ぐため、JWTトークンが安全に発行・検証されることを保証

## V.8 グラフィックス

### Major module: 高度な3D技術の実装
Pongゲームの視覚的側面を強化することに焦点を当てています。

**技術要件：**
- **使用技術：** Babylon.js
- 高度な3D技術の使用により、より没入感のあるゲーム体験を作成

**主要目標：**
- **高度な3Dグラフィックス：** Pongゲームの視覚品質を向上させるために高度な3Dグラフィックス技術を実装
- Babylon.jsを利用して、プレイヤーをゲーム環境に没入させる見事な視覚効果を作成
- **没入感のあるゲームプレイ：** 高度な3D技術の組み込みにより、ユーザーに視覚的に魅力的で魅惑的なPongゲームを提供することで全体的なゲームプレイ体験を向上
- **技術統合：** 3Dグラフィックスの作成にBabylon.jsツールを使用し、互換性と最適なパフォーマンスを保証

## V.9 アクセシビリティ
これらのモジュールは、Webアプリケーションのアクセシビリティを強化するように設計されています。

### Minor module: すべてのデバイスでのサポート
Webサイトがあらゆるタイプのデバイスでシームレスに動作することを保証することに主眼を置いています。

**主要機能と目標：**
- Webサイトがレスポンシブであることを保証（異なる画面サイズと向きに適応し、デスクトップ、ラップトップ、タブレット、スマートフォンで一貫したユーザー体験を提供）
- 使用するデバイスに応じて、タッチスクリーン、キーボード、マウスなど、異なる入力方法を使用してユーザーがWebサイトを簡単にナビゲートし操作できることを保証

**目標：**
すべてのデバイスで一貫したユーザーフレンドリーな体験を提供し、アクセシビリティとユーザー満足度を最大化する。

### Minor module: ブラウザ互換性の拡張
追加のWebブラウザサポートを追加することでWebアプリケーションの互換性を強化することを目的とします。

**主要機能と目標：**
- 追加のWebブラウザを含むようにブラウザサポートを拡張し、ユーザーがアプリケーションにシームレスにアクセス・使用できることを保証
- Webアプリケーションが新しくサポートされるブラウザで正しく機能し、正しく表示されることを保証するための徹底的なテストと最適化の実施
- 追加されたWebブラウザで発生する可能性のある互換性の問題やレンダリングの不一致への対処
- すべてのサポートされるブラウザ間で一貫したユーザー体験を保証し、使いやすさと機能性を維持

**目標：**
追加のWebブラウザをサポートすることでWebアプリケーションのアクセシビリティを広げ、ユーザーにブラウジング体験でより多くの選択肢を提供する。

### Minor module: 多言語サポート
Webアプリケーションに多言語機能を追加することを目的とします。

**主要機能と目標：**
- 複数の言語での完全なユーザーインターフェースの提供
- 言語切り替え機能の実装
- 文化的に適切なローカライゼーションの実装
- ユーザーの言語設定の保存と復元
- すべての機能とコンテンツの多言語対応

### Minor module: 視覚障害者向けアクセシビリティ機能
視覚障害のあるユーザー向けのアクセシビリティ機能を提供することを目的とします。

**主要機能と目標：**
- スクリーンリーダー対応の実装
- キーボードナビゲーションの完全サポート
- 高コントラストモードの提供
- フォントサイズ調整機能
- 音声による操作ガイダンスの実装
- WAI-ARIA標準への準拠

### Major module: サーバーサイドレンダリング（SSR）統合
パフォーマンスとユーザーエクスペリエンス向上のためのサーバーサイドレンダリング統合を目的とします。

**主要機能と目標：**
- 初期ページ読み込み時間の短縮
- SEO最適化の向上
- プログレッシブ・エンハンスメントの実装
- ハイドレーション戦略の最適化
- サーバーとクライアント間での状態管理の同期

---

## 実装優先度の指針

**採用予定モジュール [○]：**
- Web（バックエンドフレームワーク、フロントエンドフレームワーク、データベース）
- ユーザー管理（標準ユーザー管理、リモート認証）
- AI-アルゴリズム（AI対戦相手、統計ダッシュボード）
- サイバーセキュリティ（GDPR準拠、2FA/JWT）
- グラフィックス（高度な3D技術）
- アクセシビリティ（全デバイスサポート、ブラウザ互換性）

**余裕があれば実装 [△]：**
- ゲームプレイ機能（リモートプレイヤー、マルチプレイヤー）
- DevOps（ログ管理、モニタリング）

**実装しない [×]：**
- ブロックチェーン関連機能
- 追加ゲーム機能とマッチメイキング
- ライブチャット機能
- マイクロサービス設計
- 多言語サポート
- 視覚障害者向けアクセシビリティ機能
- SSR統合
- サーバーサイドPong機能
- WAF/ModSecurity & HashiCorp Vault

この要件定義書に基づいて、効率的で高品質なft_transcendenceプロジェクトの開発を進めることができます。
